<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="author" content="twmht" />
    <meta name="robots" content="index, follow"/>

    <meta property="og:title" content="Adapter Pattern -- 換個包裝再度利用"/>
    <meta property="og:url" content="http://twmht.github.io/blog/posts/2014/06/design-pattern/adapter.html"/>
    <meta property="og:site_name" content="技術筆記"/>
    <meta property="og:type" content="article"/>

    <link rel="canonical" href="http://twmht.github.io/blog/posts/2014/06/design-pattern/adapter.html" />

    <title>Adapter Pattern -- 換個包裝再度利用 | 技術筆記</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" />
    <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" />

    <link rel="stylesheet" type="text/css" href="http://twmht.github.io/blog/theme/css/main.css" />
    <link href="http://twmht.github.io/blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="技術筆記 Atom Feed" />

    <script type="text/javascript">var switchTo5x=true;</script>
    <script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
    <script type="text/javascript">
        stLight.options({
            publisher: "",
            doNotHash: false,
            doNotCopy: false,
            hashAddressBar: false
        });
    </script>
</head>

<body id="index">
    <div class="row-fluid">
        <div class="span10 offset1">
            <header id="banner" >
                <h1>
                    <a href="http://twmht.github.io/blog/">技術筆記 </a>
                </h1>
                <nav class="navbar">
                    <div class="navbar-inner">
                        <ul class="nav">
                            <li ><a href="http://twmht.github.io/blog/category/acm.html">ACM</a></li>
                            <li ><a href="http://twmht.github.io/blog/category/android.html">android</a></li>
                            <li ><a href="http://twmht.github.io/blog/category/cc.html">C/C++</a></li>
                            <li class="active"><a href="http://twmht.github.io/blog/category/design-pattern.html">Design Pattern</a></li>
                            <li ><a href="http://twmht.github.io/blog/category/multithread.html">Multithread</a></li>
                            <li ><a href="http://twmht.github.io/blog/category/others.html">Others</a></li>
                            <li ><a href="http://twmht.github.io/blog/category/python.html">Python</a></li>
                        </ul>

<script>
  (function() {
    var cx = '011100128719699788018:4mb0t5kqbse';
    var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);
  })();
</script>
<div id="google-custom-search" class="nav">
    <gcse:search></gcse:search>
</div>
                    </div>
                </nav>
            </header><!-- /#banner -->
        </div>
    </div>

    <div class="row-fluid">
        <div class="span10 offset1">
            <div class="row-fluid">
<div class="span10 offset1">
  <section>
    <article>
      <header>
        <h1 class="entry-title">
          <a href="http://twmht.github.io/blog/posts/2014/06/design-pattern/adapter.html" rel="bookmark"
             title="Permalink to Adapter Pattern -- 換個包裝再度利用">Adapter Pattern -- 換個包裝再度利用</a></h1>
      </header>
      <div class="entry-content">
<footer class="post-info">
    <address class="vcard author">
        by <a class="url fn" href="http://twmht.github.io/blog/author/twmht.html">twmht</a>
    </address>

    in <a href="http://twmht.github.io/blog/category/design-pattern.html">Design Pattern</a>

    on 2014-06-29




    
</footer><!-- /.post-info -->

        <h3>用的時間點</h3>
<p>例如將直流電換成交流電，轉換器的功能是介入既有內容和需要結果之間，作為溝通的橋樑。</p>
<p>如果既有內容無法直接利用時，通常需要先轉換成必要的型態後再使用。具有填平<strong>既有內容</strong>和<strong>需要結果</strong>兩者間的<strong>落差</strong>就是 <strong>Adapter Pattern</strong>。</p>
<h3>如何設計</h3>
<p>設計wrapper，將既有內容包裝之後，重新再利用。</p>
<h3>程式範例(繼承)</h3>
<p>改變輸出字串的外框，採用繼承。</p>
<script src="https://gist.github.com/twmht/3576c41a962cb0ef2671.js"></script>

<h3>程式範例(委讓)</h3>
<p>改變輸出字串的外框，採用委讓。</p>
<script src="https://gist.github.com/twmht/d89785e518eab0bf410e.js"></script>

<h4>Target (對象) 參與者</h4>
<p>決定現在需要什麼方法的參與者，例如筆記型電腦必須要有直流電才能動。例如 Print 介面。</p>
<h4>Client 參與者</h4>
<p>利用 Target 的方法來做事的參與者，例如有直流電 12V 才能用的比較型電腦。例如 Main 類別。</p>
<h4>Adaptee (被動符合) 參與者</h4>
<p>具有既有方法的參與者，也就是交流電 110V 的交流電電源。例如 Banner 類別。</p>
<p>如果擔任 Adaptee 參與者的方法與 Target 參與者的方法有相符時(即電源不需要轉換)，那就不需要 Adapter 參與者了。</p>
<h4>Adapter 參與者</h4>
<p>利用 Adaptee 的方法努力滿足 Target 的要求。例如，把交流電 110V 轉換成直流電 12V 的轉換器。例如 PrintBanner 類別。</p>
<p>如果是類別的 Adapter Pattern，Adapter 要透過<strong>繼承</strong>的方式來利用 Adaptee。而換到物件個體時，就要改以<strong>委讓</strong>來利用 Adaptee。</p>
<h3>優點</h3>
<h4>就算沒有原始碼也無妨</h4>
<p>Adapter Pattern 可以把過去使用過的類別換個包裝重新建立出需要的類別。因為可以確定既有類別 (Adaptee 參與者) 沒有問題，所以只要重點式地檢查 Adapter 參與者的類別即可。</p>
<p>Adapter Pattern 只要知道既有類別的規格，就能建立其它新的類別。</p>
<h4>版本更新與相容性</h4>
<p>凡是軟體都會需要做版本更新，當你在做軟體的版本更新時最常碰到的問題應該是<strong>與舊版本的相容性</strong>。利用 Adapter Pattern 可讓新舊版本共存，維護更容易。</p>
<p>假設現在完成版本更新後，就只著重在新版本而不想再維護舊版本的部份。此時，把新版本視為 Adaptee 參與者，舊版本則為 Target ，接下來只要建立一個擔任 Adapter 參與者的類別，讓它利用新版本的類別來實作舊版本即可。</p>
<p>如果 Adaptee 與 Target 功能相差太多的話，當然就不能使用 Adapter Pattern 了。</p>
<h3>問題</h3>
<p>java.util.Properties類別是用來管理 key 和相對應 value （即內容），如：</p>
<ul>
<li>year=2000 </li>
<li>month=11 </li>
<li>day=20</li>
</ul>
<p>java.util.Properties類別有下面幾個方法可從資料束（stream）讀取內容或反向寫入到 資料束。</p>
<ul>
<li>void load(InputStream in) throws IOException 從InputStream讀取內容的集合。</li>
<li>void store(OutputStream out, String header) throws IOException 把內容的集合寫入到OutputStream。header是註解字串。 </li>
</ul>
<p>請利用Adapter Pattern建立一個把內容的集合儲存成檔案的FileProperties類別。</p>
<p>假設在此是以FileIO介面（Target角色）宣告把內容的集合儲存成檔案的方
法，FileProperties類別則是實作這個FileIO介面。</p>
<p>執行前和執行後的file.txt、newfile.txt（若該行字首是#，則為java.util.Properties類別自動產生的註解）。</p>
<p><strong>如果有FileProperties類別，就算不知道java.util.Properties類別的方法，只要知道FileIO介面的方法就能處理內容。</strong></p>
<p>以電源來比喻的話，java.util.Properties類別是既有的交流電110V、FileIO介面是現在需要的直流電12V，而FileProperties類別則為轉接器。 </p>
<p><strong>實際上這個問題主要是要把本來的 java.util.Properties 包裝成 FileProperties 類別。</strong></p>
<script src="https://gist.github.com/twmht/dd1521c8d1fcf6e16d4f.js"></script>

      </div><!-- /.entry-content -->

    </article>
  </section>
</div>
            </div>
        </div>
    </div>

    <footer id="site-footer">
        <div class="row-fluid">
            <div class="span10 offset1">
                <address>
                    <p>
                        This blog is proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                    </p>
                    <p>
                        <a href="http://github.com/jsliang/pelican-fresh/">Fresh</a> is a responsive theme designed by <a href="http://jsliang.com/">jsliang</a> and <a href="https://github.com/jsliang/pelican-fresh/graphs/contributors">contributors</a>.
                        Special thanks to <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a> and <a href="http://getbootstrap.com/">Twitter Bootstrap</a>.
                    </p>
                </address>
            </div>
        </div>
    </footer>

    <script src="//code.jquery.com/jquery.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>
</body>
</html>